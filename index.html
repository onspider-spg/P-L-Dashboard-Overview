<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SPG Dashboard ‚Äî Live Data Prototype</title>
<link href="https://fonts.googleapis.com/css2?family=Instrument+Serif:ital@0;1&family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700;1,9..40,400&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.1/chart.umd.min.js"></script>
<style>
  :root {
    --bg: #09090b;
    --surface: #131316;
    --surface-2: #1a1a1f;
    --surface-3: #222228;
    --border: #27272a;
    --border-light: #333338;
    --text: #f4f4f5;
    --text-secondary: #a1a1aa;
    --text-muted: #71717a;
    --gold: #eab308;
    --gold-dim: rgba(234,179,8,0.15);
    --green: #22c55e;
    --green-dim: rgba(34,197,94,0.12);
    --red: #ef4444;
    --red-dim: rgba(239,68,68,0.12);
    --blue: #3b82f6;
    --blue-dim: rgba(59,130,246,0.12);
    --purple: #a78bfa;
    --purple-dim: rgba(167,139,250,0.12);
    --orange: #f97316;
    --teal: #14b8a6;
    --mango: #f59e0b;
    --issho: #22c55e;
    --golden: #d97706;
    --redwok: #ef4444;
    --melting: #eab308;
    --radius: 12px;
    --radius-sm: 8px;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'DM Sans', -apple-system, sans-serif;
    background: var(--bg);
    color: var(--text);
    line-height: 1.5;
    min-height: 100vh;
  }

  /* === LAYOUT === */
  .app { display: flex; min-height: 100vh; }

  .sidebar {
    width: 240px;
    background: var(--surface);
    border-right: 1px solid var(--border);
    padding: 24px 16px;
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    overflow-y: auto;
    z-index: 50;
  }

  .sidebar-logo {
    font-family: 'Instrument Serif', serif;
    font-size: 20px;
    padding: 0 8px 20px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .sidebar-logo .dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: var(--green);
    animation: blink 2s infinite;
  }

  @keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.3; }
  }

  .sidebar-section {
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 0.12em;
    text-transform: uppercase;
    color: var(--text-muted);
    padding: 16px 8px 8px;
  }

  .sidebar-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 10px 12px;
    border-radius: var(--radius-sm);
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary);
    cursor: pointer;
    transition: all 0.15s;
    margin-bottom: 2px;
    border: none;
    background: none;
    width: 100%;
    text-align: left;
    font-family: inherit;
  }

  .sidebar-item:hover { background: var(--surface-2); color: var(--text); }
  .sidebar-item.active { background: var(--gold-dim); color: var(--gold); }
  .sidebar-item .icon { font-size: 16px; width: 20px; text-align: center; }

  .main {
    flex: 1;
    margin-left: 240px;
    min-height: 100vh;
  }

  .topbar {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 32px;
    border-bottom: 1px solid var(--border);
    background: var(--surface);
    position: sticky;
    top: 0;
    z-index: 40;
  }

  .topbar-title {
    font-size: 15px;
    font-weight: 600;
  }

  .topbar-right {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .date-badge {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 14px;
    background: var(--surface-2);
    border: 1px solid var(--border);
    border-radius: 100px;
    font-size: 12px;
    color: var(--text-secondary);
  }

  .live-badge {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 6px 14px;
    background: var(--green-dim);
    border: 1px solid rgba(34,197,94,0.25);
    border-radius: 100px;
    font-size: 11px;
    font-weight: 600;
    color: var(--green);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }

  .live-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--green);
    animation: blink 1.5s infinite;
  }

  .page { padding: 28px 32px 60px; display: none; }
  .page.active { display: block; animation: fadeUp 0.3s ease; }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(8px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* === GRID === */
  .grid { display: grid; gap: 16px; margin-bottom: 24px; }
  .grid-4 { grid-template-columns: repeat(4, 1fr); }
  .grid-3 { grid-template-columns: repeat(3, 1fr); }
  .grid-2 { grid-template-columns: repeat(2, 1fr); }
  .grid-2-1 { grid-template-columns: 2fr 1fr; }
  .grid-1-2 { grid-template-columns: 1fr 2fr; }

  @media (max-width: 1100px) {
    .grid-4 { grid-template-columns: repeat(2, 1fr); }
    .grid-3 { grid-template-columns: 1fr; }
    .grid-2, .grid-2-1, .grid-1-2 { grid-template-columns: 1fr; }
    .sidebar { display: none; }
    .main { margin-left: 0; }
  }

  /* === CARDS === */
  .card {
    background: var(--surface);
    border: 1px solid var(--border);
    border-radius: var(--radius);
    padding: 20px;
  }

  .card-header {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    margin-bottom: 16px;
  }

  .card-title {
    font-size: 13px;
    font-weight: 500;
    color: var(--text-secondary);
  }

  .card-icon {
    width: 32px;
    height: 32px;
    border-radius: var(--radius-sm);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 16px;
  }

  /* === STAT CARDS === */
  .stat-value {
    font-family: 'DM Sans', sans-serif;
    font-size: 28px;
    font-weight: 700;
    letter-spacing: -0.02em;
    margin-bottom: 4px;
  }

  .stat-change {
    display: inline-flex;
    align-items: center;
    gap: 4px;
    font-size: 12px;
    font-weight: 600;
    padding: 2px 8px;
    border-radius: 100px;
  }

  .stat-change.up {
    color: var(--green);
    background: var(--green-dim);
  }

  .stat-change.down {
    color: var(--red);
    background: var(--red-dim);
  }

  .stat-sub {
    font-size: 12px;
    color: var(--text-muted);
    margin-top: 4px;
  }

  /* === CHART AREA === */
  .chart-container {
    position: relative;
    width: 100%;
    height: 280px;
  }

  .chart-container-sm {
    position: relative;
    width: 100%;
    height: 200px;
  }

  /* === TABLE === */
  .data-table {
    width: 100%;
    border-collapse: collapse;
  }

  .data-table th {
    text-align: left;
    font-size: 11px;
    font-weight: 600;
    letter-spacing: 0.05em;
    text-transform: uppercase;
    color: var(--text-muted);
    padding: 10px 12px;
    border-bottom: 1px solid var(--border);
  }

  .data-table td {
    padding: 12px;
    font-size: 13px;
    border-bottom: 1px solid var(--border);
    color: var(--text-secondary);
  }

  .data-table tr:last-child td { border-bottom: none; }

  .data-table tr:hover td { background: var(--surface-2); }

  .brand-cell {
    display: flex;
    align-items: center;
    gap: 10px;
    font-weight: 600;
    color: var(--text);
  }

  .brand-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
  }

  .val-positive { color: var(--green); }
  .val-negative { color: var(--red); }

  /* === P&L === */
  .pnl-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 12px 0;
    border-bottom: 1px solid var(--border);
    font-size: 14px;
  }

  .pnl-row:last-child { border-bottom: none; }

  .pnl-label { color: var(--text-secondary); }

  .pnl-value { font-weight: 600; font-variant-numeric: tabular-nums; }

  .pnl-row.total {
    border-top: 2px solid var(--border-light);
    border-bottom: none;
    padding-top: 16px;
    margin-top: 4px;
  }

  .pnl-row.total .pnl-label { font-weight: 700; color: var(--text); }
  .pnl-row.total .pnl-value { font-size: 18px; }

  /* === SECTION TITLE === */
  .section-title {
    font-family: 'Instrument Serif', serif;
    font-size: 24px;
    font-weight: 400;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .section-desc {
    font-size: 13px;
    color: var(--text-muted);
    margin-bottom: 24px;
    max-width: 600px;
  }

  /* === DATA SOURCE INDICATOR === */
  .data-source {
    display: inline-flex;
    align-items: center;
    gap: 6px;
    font-size: 11px;
    color: var(--text-muted);
    background: var(--surface-2);
    padding: 4px 10px;
    border-radius: 100px;
    margin-bottom: 16px;
  }

  .data-source .gs-icon {
    width: 14px;
    height: 14px;
    background: var(--green);
    border-radius: 3px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 9px;
    font-weight: 700;
    color: white;
  }

  /* === HEATMAP === */
  .heatmap {
    display: grid;
    grid-template-columns: 60px repeat(7, 1fr);
    gap: 3px;
    font-size: 11px;
  }

  .heatmap-label {
    display: flex;
    align-items: center;
    color: var(--text-muted);
    font-size: 11px;
    padding-right: 8px;
  }

  .heatmap-header {
    text-align: center;
    color: var(--text-muted);
    font-size: 11px;
    font-weight: 600;
    padding-bottom: 6px;
  }

  .heatmap-cell {
    aspect-ratio: 1;
    border-radius: 4px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 10px;
    font-weight: 600;
    color: rgba(255,255,255,0.7);
    min-height: 36px;
    transition: transform 0.15s;
  }

  .heatmap-cell:hover {
    transform: scale(1.1);
    z-index: 2;
  }

  /* === ALERT BANNER === */
  .alert-banner {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 14px 20px;
    border-radius: var(--radius);
    margin-bottom: 20px;
    font-size: 13px;
  }

  .alert-warning {
    background: rgba(234,179,8,0.08);
    border: 1px solid rgba(234,179,8,0.2);
    color: var(--gold);
  }

  .alert-info {
    background: var(--blue-dim);
    border: 1px solid rgba(59,130,246,0.2);
    color: var(--blue);
  }

  /* === SPARKLINE INLINE === */
  .mini-bar {
    display: flex;
    align-items: flex-end;
    gap: 2px;
    height: 24px;
  }

  .mini-bar span {
    width: 4px;
    border-radius: 2px;
    transition: height 0.3s;
  }

  /* === SCROLLBAR === */
  ::-webkit-scrollbar { width: 6px; }
  ::-webkit-scrollbar-track { background: transparent; }
  ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
</style>
</head>
<body>

<div class="app">
  <!-- SIDEBAR -->
  <nav class="sidebar">
    <div class="sidebar-logo">
      <span class="dot"></span>
      SPG Dashboard
    </div>

    <div class="sidebar-section">Overview</div>
    <button class="sidebar-item active" onclick="showPage('overview', this)">
      <span class="icon">üìä</span> Dashboard
    </button>
    <button class="sidebar-item" onclick="showPage('pnl', this)">
      <span class="icon">üí∞</span> P&L Statement
    </button>

    <div class="sidebar-section">Brands</div>
    <button class="sidebar-item" onclick="showPage('brands', this)">
      <span class="icon">üè™</span> All Brands
    </button>
    <button class="sidebar-item" onclick="showPage('melting', this)">
      <span class="icon">üßÄ</span> The Melting Cheese
    </button>

    <div class="sidebar-section">Traffic</div>
    <button class="sidebar-item" onclick="showPage('traffic', this)">
      <span class="icon">üö∂</span> Foot Traffic
    </button>
    <button class="sidebar-item" onclick="showPage('heatmap', this)">
      <span class="icon">üî•</span> Traffic Heatmap
    </button>

    <div class="sidebar-section">Marketing</div>
    <button class="sidebar-item" onclick="showPage('marketing', this)">
      <span class="icon">üì±</span> Social & Campaigns
    </button>

    <div style="flex:1"></div>
    <div style="padding:16px 8px; border-top:1px solid var(--border); margin-top:20px;">
      <div style="font-size:11px; color:var(--text-muted);">Data Source</div>
      <div style="font-size:12px; color:var(--text-secondary); margin-top:4px; display:flex; align-items:center; gap:6px;">
        <span style="color:var(--green)">‚óè</span> Google Sheets (Live)
      </div>
      <div style="font-size:10px; color:var(--text-muted); margin-top:4px;">Last sync: 2 min ago</div>
    </div>
  </nav>

  <!-- MAIN CONTENT -->
  <div class="main">
    <div class="topbar">
      <div class="topbar-title">Siam Palette Group</div>
      <div class="topbar-right">
        <div class="date-badge">üìÖ Feb 2026</div>
        <div class="live-badge"><span class="live-dot"></span> Live Data</div>
      </div>
    </div>

    <!-- ==================== OVERVIEW ==================== -->
    <div class="page active" id="page-overview">
      <div class="section-title">üìä Dashboard Overview</div>
      <div class="data-source">
        <div class="gs-icon">G</div>
        Synced from: SPG_Master_Transactions.gsheet
      </div>

      <div class="grid grid-4">
        <div class="card">
          <div class="card-header">
            <div class="card-title">Total Revenue</div>
            <div class="card-icon" style="background:var(--green-dim)">üíµ</div>
          </div>
          <div class="stat-value">$487,200</div>
          <div><span class="stat-change up">‚Üë 12.3%</span></div>
          <div class="stat-sub">vs last month: $433,800</div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">Total Costs</div>
            <div class="card-icon" style="background:var(--red-dim)">üìâ</div>
          </div>
          <div class="stat-value">$389,760</div>
          <div><span class="stat-change down">‚Üë 8.1%</span></div>
          <div class="stat-sub">COGS + Labour + Overhead</div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">Net Profit</div>
            <div class="card-icon" style="background:var(--gold-dim)">‚ú®</div>
          </div>
          <div class="stat-value" style="color:var(--green)">$97,440</div>
          <div><span class="stat-change up">‚Üë 31.2%</span></div>
          <div class="stat-sub">Margin: 20.0%</div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">Total Foot Traffic</div>
            <div class="card-icon" style="background:var(--blue-dim)">üö∂</div>
          </div>
          <div class="stat-value">18,420</div>
          <div><span class="stat-change up">‚Üë 8.7%</span></div>
          <div class="stat-sub">All locations combined</div>
        </div>
      </div>

      <div class="grid grid-2-1">
        <div class="card">
          <div class="card-header">
            <div class="card-title">Revenue Trend ‚Äî 6 Months</div>
          </div>
          <div class="chart-container">
            <canvas id="revenueChart"></canvas>
          </div>
        </div>

        <div class="card">
          <div class="card-header">
            <div class="card-title">Revenue Split by Brand</div>
          </div>
          <div class="chart-container">
            <canvas id="brandPieChart"></canvas>
          </div>
        </div>
      </div>

      <div class="alert-warning alert-banner">
        ‚ö†Ô∏è <strong>The Melting Cheese:</strong>&nbsp; Repeat visit rate ‡∏ï‡πà‡∏≥‡∏Å‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πâ‡∏≤ (12% vs target 25%) ‚Äî ‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏£‡πà‡∏á loyalty program
      </div>
    </div>

    <!-- ==================== P&L ==================== -->
    <div class="page" id="page-pnl">
      <div class="section-title">üí∞ Profit & Loss Statement</div>
      <div class="data-source">
        <div class="gs-icon">G</div>
        Synced from: SPG_BankStatements.gsheet + SPG_Expenses.gsheet
      </div>
      <div class="section-desc">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏î‡∏∑‡∏≠‡∏ô February 2026 ‚Äî ‡∏î‡∏∂‡∏á‡∏à‡∏≤‡∏Å bank statement ‡πÅ‡∏•‡∏∞ expense records ‡πÉ‡∏ô Google Sheets ‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥</div>

      <div class="grid grid-2">
        <div class="card">
          <h3 style="font-size:15px; font-weight:600; margin-bottom:16px; color:var(--text)">
            üìä SPG Group ‚Äî Feb 2026
          </h3>
          <div class="pnl-row">
            <span class="pnl-label">üçß Mango Coco Revenue</span>
            <span class="pnl-value">$168,500</span>
          </div>
          <div class="pnl-row">
            <span class="pnl-label">üßÄ The Melting Cheese Revenue</span>
            <span class="pnl-value">$72,300</span>
          </div>
          <div class="pnl-row">
            <span class="pnl-label">üçµ Issho Cafe Revenue</span>
            <span class="pnl-value">$89,400</span>
          </div>
          <div class="pnl-row">
            <span class="pnl-label">ü•û Golden Brown Revenue</span>
            <span class="pnl-value">$78,200</span>
          </div>
          <div class="pnl-row">
            <span class="pnl-label">üçú Red Wok Revenue</span>
            <span class="pnl-value">$78,800</span>
          </div>
          <div class="pnl-row total">
            <span class="pnl-label">Total Revenue</span>
            <span class="pnl-value" style="color:var(--green)">$487,200</span>
          </div>

          <div style="height:20px"></div>

          <div class="pnl-row">
            <span class="pnl-label">COGS (Food & Beverage)</span>
            <span class="pnl-value" style="color:var(--red)">-$155,900</span>
          </div>
          <div class="pnl-row">
            <span class="pnl-label">Labour Cost</span>
            <span class="pnl-value" style="color:var(--red)">-$145,200</span>
          </div>
          <div class="pnl-row">
            <span class="pnl-label">Rent & Occupancy</span>
            <span class="pnl-value" style="color:var(--red)">-$52,800</span>
          </div>
          <div class="pnl-row">
            <span class="pnl-label">Marketing & Advertising</span>
            <span class="pnl-value" style="color:var(--red)">-$12,400</span>
          </div>
          <div class="pnl-row">
            <span class="pnl-label">Utilities & Other</span>
            <span class="pnl-value" style="color:var(--red)">-$23,460</span>
          </div>
          <div class="pnl-row total">
            <span class="pnl-label">Total Expenses</span>
            <span class="pnl-value" style="color:var(--red)">-$389,760</span>
          </div>

          <div style="height:16px"></div>

          <div class="pnl-row total" style="background:var(--gold-dim); padding:16px 20px; border-radius:var(--radius-sm); border:1px solid rgba(234,179,8,0.2);">
            <span class="pnl-label" style="color:var(--gold); font-size:16px;">‚ú® Net Profit</span>
            <span class="pnl-value" style="color:var(--gold); font-size:24px;">$97,440</span>
          </div>
        </div>

        <div>
          <div class="card" style="margin-bottom:16px">
            <div class="card-header">
              <div class="card-title">Cost Breakdown</div>
            </div>
            <div class="chart-container-sm">
              <canvas id="costBreakdownChart"></canvas>
            </div>
          </div>

          <div class="card" style="margin-bottom:16px">
            <div class="card-header">
              <div class="card-title">Profit Margin by Brand</div>
            </div>
            <div class="chart-container-sm">
              <canvas id="marginChart"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- ==================== BRANDS ==================== -->
    <div class="page" id="page-brands">
      <div class="section-title">üè™ Brand Performance</div>
      <div class="data-source">
        <div class="gs-icon">G</div>
        Synced from: SPG_POS_Daily.gsheet
      </div>

      <div class="card" style="margin-bottom:24px; overflow-x:auto;">
        <table class="data-table">
          <thead>
            <tr>
              <th>Brand</th>
              <th>Revenue</th>
              <th>Transactions</th>
              <th>Avg Spend</th>
              <th>Foot Traffic</th>
              <th>vs Last Month</th>
              <th>Margin</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td><div class="brand-cell"><div class="brand-dot" style="background:var(--mango)"></div>Mango Coco</div></td>
              <td style="font-weight:600; color:var(--text)">$168,500</td>
              <td>5,280</td>
              <td>$31.90</td>
              <td>6,150</td>
              <td class="val-positive">+14.2%</td>
              <td>22.5%</td>
            </tr>
            <tr>
              <td><div class="brand-cell"><div class="brand-dot" style="background:var(--issho)"></div>Issho Cafe</div></td>
              <td style="font-weight:600; color:var(--text)">$89,400</td>
              <td>2,810</td>
              <td>$31.80</td>
              <td>3,420</td>
              <td class="val-positive">+9.1%</td>
              <td>21.3%</td>
            </tr>
            <tr>
              <td><div class="brand-cell"><div class="brand-dot" style="background:var(--golden)"></div>Golden Brown</div></td>
              <td style="font-weight:600; color:var(--text)">$78,200</td>
              <td>2,450</td>
              <td>$31.90</td>
              <td>2,980</td>
              <td class="val-positive">+6.5%</td>
              <td>18.7%</td>
            </tr>
            <tr>
              <td><div class="brand-cell"><div class="brand-dot" style="background:var(--redwok)"></div>Red Wok</div></td>
              <td style="font-weight:600; color:var(--text)">$78,800</td>
              <td>4,120</td>
              <td>$19.10</td>
              <td>4,280</td>
              <td class="val-positive">+5.3%</td>
              <td>19.2%</td>
            </tr>
            <tr style="background:rgba(234,179,8,0.04)">
              <td><div class="brand-cell"><div class="brand-dot" style="background:var(--melting)"></div>The Melting Cheese ‚ö†Ô∏è</div></td>
              <td style="font-weight:600; color:var(--text)">$72,300</td>
              <td>1,890</td>
              <td>$38.30</td>
              <td>1,590</td>
              <td class="val-negative">-3.2%</td>
              <td>15.8%</td>
            </tr>
          </tbody>
        </table>
      </div>

      <div class="card">
        <div class="card-header">
          <div class="card-title">Revenue by Brand ‚Äî 6 Month Trend</div>
        </div>
        <div class="chart-container">
          <canvas id="brandTrendChart"></canvas>
        </div>
      </div>
    </div>

    <!-- ==================== MELTING CHEESE ==================== -->
    <div class="page" id="page-melting">
      <div class="section-title">üßÄ The Melting Cheese ‚Äî Deep Dive</div>
      <div class="data-source">
        <div class="gs-icon">G</div>
        Synced from: TMC_POS_Detail.gsheet
      </div>

      <div class="alert-warning alert-banner">
        ‚ö†Ô∏è Foot traffic ‡∏•‡∏î‡∏•‡∏á 3.2% ‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏Å‡πà‡∏≠‡∏ô ‚Äî repeat visit rate ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà 12% (‡πÄ‡∏õ‡πâ‡∏≤ 25%)
      </div>

      <div class="grid grid-4">
        <div class="card">
          <div class="card-title">Revenue</div>
          <div class="stat-value" style="font-size:24px">$72,300</div>
          <span class="stat-change down">‚Üì 3.2%</span>
        </div>
        <div class="card">
          <div class="card-title">Daily Avg Customers</div>
          <div class="stat-value" style="font-size:24px">57</div>
          <span class="stat-change down">‚Üì 5.1%</span>
        </div>
        <div class="card">
          <div class="card-title">Avg Spend / Person</div>
          <div class="stat-value" style="font-size:24px">$38.30</div>
          <span class="stat-change up">‚Üë 2.1%</span>
        </div>
        <div class="card">
          <div class="card-title">Repeat Visit Rate</div>
          <div class="stat-value" style="font-size:24px; color:var(--red)">12%</div>
          <div class="stat-sub">Target: 25%</div>
        </div>
      </div>

      <div class="grid grid-2">
        <div class="card">
          <div class="card-header">
            <div class="card-title">Daily Revenue ‚Äî Feb 2026</div>
          </div>
          <div class="chart-container">
            <canvas id="tmcDailyChart"></canvas>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">Top Selling Items</div>
          </div>
          <table class="data-table">
            <thead>
              <tr><th>Item</th><th>Units</th><th>Revenue</th><th>%</th></tr>
            </thead>
            <tbody>
              <tr><td style="color:var(--text)">ü•ê Egg Vanilla Croissant Tart</td><td>842</td><td>$7,505</td><td>10.4%</td></tr>
              <tr><td style="color:var(--text)">üßÄ Cheese Custard Tart</td><td>756</td><td>$8,240</td><td>11.4%</td></tr>
              <tr><td style="color:var(--text)">üçù Spicy Carbonara</td><td>534</td><td>$15,430</td><td>21.3%</td></tr>
              <tr><td style="color:var(--text)">üçî Melting Cheeseburger</td><td>421</td><td>$10,903</td><td>15.1%</td></tr>
              <tr><td style="color:var(--text)">üçµ Matcha Mochi Tart</td><td>389</td><td>$4,240</td><td>5.9%</td></tr>
              <tr><td style="color:var(--text)">‚òï Cheese Foam Latte</td><td>612</td><td>$5,508</td><td>7.6%</td></tr>
            </tbody>
          </table>
        </div>
      </div>

      <div class="card" style="margin-top:16px">
        <div class="card-header">
          <div class="card-title">‚ö° Key Issues & Recommended Actions</div>
        </div>
        <table class="data-table">
          <thead>
            <tr><th>Issue</th><th>Data Signal</th><th>Action</th><th>Priority</th></tr>
          </thead>
          <tbody>
            <tr>
              <td style="color:var(--text)">‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏Å‡∏•‡∏±‡∏ö‡∏°‡∏≤‡∏ã‡πâ‡∏≥</td>
              <td>Repeat rate 12%</td>
              <td>Launch stamp card + "Melt of the Month"</td>
              <td><span class="stat-change down" style="font-size:11px">üî¥ Critical</span></td>
            </tr>
            <tr>
              <td style="color:var(--text)">Weekday traffic ‡∏ï‡πà‡∏≥</td>
              <td>Mon-Thu avg 38 covers vs Sat 96</td>
              <td>Weekday lunch set + Happy Hour 3-5pm</td>
              <td><span class="stat-change down" style="font-size:11px">üî¥ Critical</span></td>
            </tr>
            <tr>
              <td style="color:var(--text)">L1 visibility ‡∏ï‡πà‡∏≥</td>
              <td>Walk-in ratio 22% (vs MC 45%)</td>
              <td>A-frame sign + street-level branding</td>
              <td><span style="font-size:11px; color:var(--orange)">üü† High</span></td>
            </tr>
            <tr>
              <td style="color:var(--text)">Avg spend ‡∏™‡∏π‡∏á‡πÅ‡∏ï‡πà volume ‡∏ï‡πà‡∏≥</td>
              <td>$38.30 avg (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î‡πÉ‡∏ô‡∏Å‡∏•‡∏∏‡πà‡∏°)</td>
              <td>‡πÄ‡∏û‡∏¥‡πà‡∏° entry-level items + pastry grab-and-go</td>
              <td><span style="font-size:11px; color:var(--gold)">üü° Medium</span></td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ==================== FOOT TRAFFIC ==================== -->
    <div class="page" id="page-traffic">
      <div class="section-title">üö∂ Foot Traffic Analytics</div>
      <div class="data-source">
        <div class="gs-icon">G</div>
        Synced from: SPG_POS_Hourly.gsheet
      </div>

      <div class="grid grid-2">
        <div class="card">
          <div class="card-header">
            <div class="card-title">Weekly Foot Traffic ‚Äî All Brands</div>
          </div>
          <div class="chart-container">
            <canvas id="weeklyTrafficChart"></canvas>
          </div>
        </div>
        <div class="card">
          <div class="card-header">
            <div class="card-title">Traffic by Day of Week</div>
          </div>
          <div class="chart-container">
            <canvas id="dayOfWeekChart"></canvas>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-header">
          <div class="card-title">Hourly Traffic Pattern ‚Äî Average Day</div>
        </div>
        <div class="chart-container">
          <canvas id="hourlyChart"></canvas>
        </div>
      </div>
    </div>

    <!-- ==================== HEATMAP ==================== -->
    <div class="page" id="page-heatmap">
      <div class="section-title">üî• Traffic Heatmap</div>
      <div class="section-desc">‡πÅ‡∏™‡∏î‡∏á‡∏à‡∏≥‡∏ô‡∏ß‡∏ô transactions ‡∏ï‡∏≤‡∏° ‡∏ß‡∏±‡∏ô √ó ‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ß‡∏•‡∏≤ ‚Äî ‡∏™‡∏µ‡πÄ‡∏Ç‡πâ‡∏° = traffic ‡∏™‡∏π‡∏á, ‡∏™‡∏µ‡∏à‡∏≤‡∏á = traffic ‡∏ï‡πà‡∏≥</div>
      <div class="data-source">
        <div class="gs-icon">G</div>
        Synced from: SPG_POS_Hourly.gsheet
      </div>

      <div class="card">
        <div class="card-header"><div class="card-title">All SPG Brands ‚Äî Weekly Heatmap (Avg Covers per Slot)</div></div>
        <div id="heatmapGrid" style="margin-top:12px;"></div>
      </div>

      <div style="height:24px"></div>

      <div class="card">
        <div class="card-header"><div class="card-title">üßÄ The Melting Cheese ‚Äî Weekly Heatmap</div></div>
        <div id="heatmapTMC" style="margin-top:12px;"></div>
      </div>
    </div>

    <!-- ==================== MARKETING ==================== -->
    <div class="page" id="page-marketing">
      <div class="section-title">üì± Social Media & Campaign Tracker</div>
      <div class="data-source">
        <div class="gs-icon">G</div>
        Synced from: SPG_Social_Metrics.gsheet + SPG_Campaign_Log.gsheet
      </div>

      <div class="grid grid-4">
        <div class="card">
          <div class="card-title">Instagram Followers (Total)</div>
          <div class="stat-value" style="font-size:22px">42,800</div>
          <span class="stat-change up">‚Üë 8.2%</span>
        </div>
        <div class="card">
          <div class="card-title">TikTok Views (Feb)</div>
          <div class="stat-value" style="font-size:22px">284K</div>
          <span class="stat-change up">‚Üë 45.3%</span>
        </div>
        <div class="card">
          <div class="card-title">Promo Code Redemptions</div>
          <div class="stat-value" style="font-size:22px">347</div>
          <span class="stat-change up">‚Üë 22%</span>
        </div>
        <div class="card">
          <div class="card-title">Google Review Avg</div>
          <div class="stat-value" style="font-size:22px">4.3 ‚≠ê</div>
          <div class="stat-sub">+18 new reviews this month</div>
        </div>
      </div>

      <div class="grid grid-2">
        <div class="card">
          <div class="card-header"><div class="card-title">Instagram Follower Growth</div></div>
          <div class="chart-container">
            <canvas id="igGrowthChart"></canvas>
          </div>
        </div>
        <div class="card">
          <div class="card-header"><div class="card-title">Campaign Performance</div></div>
          <table class="data-table">
            <thead>
              <tr><th>Campaign</th><th>Channel</th><th>Reach</th><th>Visits</th><th>ROI</th></tr>
            </thead>
            <tbody>
              <tr>
                <td style="color:var(--text)">Melt of the Month #1</td>
                <td>IG + TikTok</td>
                <td>45.2K</td>
                <td>189</td>
                <td class="val-positive">3.2x</td>
              </tr>
              <tr>
                <td style="color:var(--text)">MC x TMC Cross-promo</td>
                <td>In-store</td>
                <td>2.1K coupons</td>
                <td>312</td>
                <td class="val-positive">5.1x</td>
              </tr>
              <tr>
                <td style="color:var(--text)">Weekday Lunch Set</td>
                <td>IG Stories</td>
                <td>12.8K</td>
                <td>94</td>
                <td class="val-positive">2.8x</td>
              </tr>
              <tr>
                <td style="color:var(--text)">Micro-influencer batch #1</td>
                <td>TikTok</td>
                <td>128K</td>
                <td>~210</td>
                <td class="val-positive">4.5x</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
// === NAVIGATION ===
function showPage(id, btn) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.sidebar-item').forEach(b => b.classList.remove('active'));
  document.getElementById('page-' + id).classList.add('active');
  if (btn) btn.classList.add('active');
  initCharts(id);
}

// === CHART DEFAULTS ===
Chart.defaults.color = '#71717a';
Chart.defaults.borderColor = '#27272a';
Chart.defaults.font.family = 'DM Sans';
Chart.defaults.font.size = 11;
Chart.defaults.plugins.legend.labels.boxWidth = 12;
Chart.defaults.plugins.legend.labels.padding = 16;

const chartInstances = {};

function destroyChart(id) {
  if (chartInstances[id]) { chartInstances[id].destroy(); delete chartInstances[id]; }
}

// === INIT CHARTS ===
function initCharts(page) {
  if (page === 'overview') { initRevenueChart(); initBrandPieChart(); }
  if (page === 'pnl') { initCostBreakdown(); initMarginChart(); }
  if (page === 'brands') { initBrandTrend(); }
  if (page === 'melting') { initTMCDaily(); }
  if (page === 'traffic') { initWeeklyTraffic(); initDayOfWeek(); initHourly(); }
  if (page === 'heatmap') { buildHeatmap('heatmapGrid', heatmapDataAll); buildHeatmap('heatmapTMC', heatmapDataTMC); }
  if (page === 'marketing') { initIGGrowth(); }
}

// === OVERVIEW CHARTS ===
function initRevenueChart() {
  destroyChart('revenueChart');
  chartInstances['revenueChart'] = new Chart(document.getElementById('revenueChart'), {
    type: 'line',
    data: {
      labels: ['Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'],
      datasets: [{
        label: 'Revenue',
        data: [398000, 412000, 425000, 461000, 433800, 487200],
        borderColor: '#22c55e',
        backgroundColor: 'rgba(34,197,94,0.08)',
        fill: true,
        tension: 0.4,
        pointRadius: 4,
        pointBackgroundColor: '#22c55e'
      }, {
        label: 'Expenses',
        data: [338000, 349000, 356000, 382000, 360600, 389760],
        borderColor: '#ef4444',
        backgroundColor: 'rgba(239,68,68,0.05)',
        fill: true,
        tension: 0.4,
        pointRadius: 4,
        pointBackgroundColor: '#ef4444'
      }]
    },
    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'top' } }, scales: { y: { beginAtZero: false, ticks: { callback: v => '$' + (v/1000) + 'K' } } } }
  });
}

function initBrandPieChart() {
  destroyChart('brandPieChart');
  chartInstances['brandPieChart'] = new Chart(document.getElementById('brandPieChart'), {
    type: 'doughnut',
    data: {
      labels: ['Mango Coco', 'Issho', 'Golden Brown', 'Red Wok', 'Melting Cheese'],
      datasets: [{
        data: [168500, 89400, 78200, 78800, 72300],
        backgroundColor: ['#f59e0b', '#22c55e', '#d97706', '#ef4444', '#eab308'],
        borderWidth: 0
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { position: 'right', labels: { padding: 12 } } },
      cutout: '60%'
    }
  });
}

// === P&L CHARTS ===
function initCostBreakdown() {
  destroyChart('costBreakdownChart');
  chartInstances['costBreakdownChart'] = new Chart(document.getElementById('costBreakdownChart'), {
    type: 'doughnut',
    data: {
      labels: ['COGS', 'Labour', 'Rent', 'Marketing', 'Other'],
      datasets: [{
        data: [155900, 145200, 52800, 12400, 23460],
        backgroundColor: ['#ef4444', '#f97316', '#eab308', '#3b82f6', '#71717a'],
        borderWidth: 0
      }]
    },
    options: { responsive: true, maintainAspectRatio: false, cutout: '55%', plugins: { legend: { position: 'bottom', labels: { padding: 8, font: { size: 10 } } } } }
  });
}

function initMarginChart() {
  destroyChart('marginChart');
  chartInstances['marginChart'] = new Chart(document.getElementById('marginChart'), {
    type: 'bar',
    data: {
      labels: ['Mango Coco', 'Issho', 'Golden Brown', 'Red Wok', 'TMC'],
      datasets: [{
        label: 'Margin %',
        data: [22.5, 21.3, 18.7, 19.2, 15.8],
        backgroundColor: ['#f59e0b', '#22c55e', '#d97706', '#ef4444', '#eab308'],
        borderRadius: 6
      }]
    },
    options: {
      responsive: true, maintainAspectRatio: false, indexAxis: 'y',
      plugins: { legend: { display: false } },
      scales: { x: { beginAtZero: true, max: 30, ticks: { callback: v => v + '%' } } }
    }
  });
}

// === BRAND TREND ===
function initBrandTrend() {
  destroyChart('brandTrendChart');
  chartInstances['brandTrendChart'] = new Chart(document.getElementById('brandTrendChart'), {
    type: 'line',
    data: {
      labels: ['Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'],
      datasets: [
        { label: 'Mango Coco', data: [142000, 148000, 155000, 165000, 147600, 168500], borderColor: '#f59e0b', tension: 0.4, pointRadius: 3 },
        { label: 'Issho', data: [78000, 80000, 82000, 88000, 82000, 89400], borderColor: '#22c55e', tension: 0.4, pointRadius: 3 },
        { label: 'Golden Brown', data: [62000, 65000, 68000, 72000, 73500, 78200], borderColor: '#d97706', tension: 0.4, pointRadius: 3 },
        { label: 'Red Wok', data: [72000, 74000, 75000, 78000, 74800, 78800], borderColor: '#ef4444', tension: 0.4, pointRadius: 3 },
        { label: 'Melting Cheese', data: [44000, 45000, 45000, 58000, 55900, 72300], borderColor: '#eab308', tension: 0.4, pointRadius: 3, borderDash: [5, 5] }
      ]
    },
    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'top' } }, scales: { y: { ticks: { callback: v => '$' + (v/1000) + 'K' } } } }
  });
}

// === TMC DAILY ===
function initTMCDaily() {
  destroyChart('tmcDailyChart');
  const days = Array.from({length: 28}, (_, i) => i + 1);
  const revenue = days.map(d => {
    const dow = new Date(2026, 1, d).getDay();
    const base = dow === 0 || dow === 6 ? 3800 : 1900;
    return base + Math.random() * 800 - 200;
  });
  chartInstances['tmcDailyChart'] = new Chart(document.getElementById('tmcDailyChart'), {
    type: 'bar',
    data: {
      labels: days.map(d => d.toString()),
      datasets: [{
        label: 'Revenue',
        data: revenue,
        backgroundColor: revenue.map(v => v > 3000 ? 'rgba(234,179,8,0.6)' : 'rgba(234,179,8,0.25)'),
        borderRadius: 3
      }]
    },
    options: {
      responsive: true, maintainAspectRatio: false,
      plugins: { legend: { display: false } },
      scales: { y: { ticks: { callback: v => '$' + v.toFixed(0) } }, x: { ticks: { font: { size: 9 } } } }
    }
  });
}

// === TRAFFIC CHARTS ===
function initWeeklyTraffic() {
  destroyChart('weeklyTrafficChart');
  chartInstances['weeklyTrafficChart'] = new Chart(document.getElementById('weeklyTrafficChart'), {
    type: 'line',
    data: {
      labels: ['W1', 'W2', 'W3', 'W4', 'W5', 'W6', 'W7', 'W8'],
      datasets: [
        { label: 'This Period', data: [4200, 4350, 4180, 4620, 4450, 4700, 4580, 4920], borderColor: '#3b82f6', backgroundColor: 'rgba(59,130,246,0.1)', fill: true, tension: 0.4 },
        { label: 'Previous Period', data: [3900, 4000, 3850, 4100, 4050, 4200, 4100, 4300], borderColor: '#71717a', borderDash: [4,4], tension: 0.4, pointRadius: 2 }
      ]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });
}

function initDayOfWeek() {
  destroyChart('dayOfWeekChart');
  chartInstances['dayOfWeekChart'] = new Chart(document.getElementById('dayOfWeekChart'), {
    type: 'bar',
    data: {
      labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
      datasets: [{
        label: 'Avg Covers',
        data: [480, 510, 520, 540, 720, 890, 760],
        backgroundColor: ['#3b82f6', '#3b82f6', '#3b82f6', '#3b82f6', '#22c55e', '#22c55e', '#22c55e'],
        borderRadius: 6
      }]
    },
    options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } } }
  });
}

function initHourly() {
  destroyChart('hourlyChart');
  chartInstances['hourlyChart'] = new Chart(document.getElementById('hourlyChart'), {
    type: 'line',
    data: {
      labels: ['8am', '9am', '10am', '11am', '12pm', '1pm', '2pm', '3pm', '4pm', '5pm', '6pm', '7pm', '8pm', '9pm'],
      datasets: [
        { label: 'Weekday', data: [15, 28, 45, 62, 85, 78, 52, 35, 30, 42, 58, 65, 48, 22], borderColor: '#3b82f6', tension: 0.4, fill: false },
        { label: 'Weekend', data: [20, 42, 68, 92, 110, 105, 88, 72, 55, 65, 82, 95, 78, 40], borderColor: '#22c55e', tension: 0.4, fill: false }
      ]
    },
    options: { responsive: true, maintainAspectRatio: false, scales: { y: { title: { display: true, text: 'Covers', font: { size: 11 } } } } }
  });
}

// === HEATMAP ===
const heatmapDataAll = {
  rows: ['8-10am', '10-12pm', '12-2pm', '2-4pm', '4-6pm', '6-8pm', '8-10pm'],
  cols: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
  values: [
    [12, 14, 13, 15, 18, 32, 28],
    [28, 30, 32, 34, 42, 68, 58],
    [52, 55, 54, 58, 72, 95, 82],
    [25, 22, 24, 26, 35, 62, 55],
    [20, 22, 25, 28, 45, 58, 48],
    [35, 38, 40, 42, 62, 78, 65],
    [22, 25, 28, 30, 48, 55, 38]
  ]
};

const heatmapDataTMC = {
  rows: ['8-10am', '10-12pm', '12-2pm', '2-4pm', '4-6pm', '6-8pm', '8-10pm'],
  cols: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
  values: [
    [2, 3, 2, 3, 4, 12, 10],
    [5, 6, 5, 7, 10, 22, 18],
    [12, 11, 13, 14, 18, 28, 24],
    [4, 3, 4, 5, 8, 18, 15],
    [3, 3, 4, 5, 10, 15, 12],
    [8, 7, 9, 10, 15, 22, 18],
    [5, 4, 5, 6, 10, 12, 8]
  ]
};

function buildHeatmap(containerId, data) {
  const container = document.getElementById(containerId);
  container.innerHTML = '';
  const maxVal = Math.max(...data.values.flat());

  let html = '<div class="heatmap">';
  html += '<div></div>';
  data.cols.forEach(c => { html += `<div class="heatmap-header">${c}</div>`; });

  data.rows.forEach((row, ri) => {
    html += `<div class="heatmap-label">${row}</div>`;
    data.cols.forEach((_, ci) => {
      const val = data.values[ri][ci];
      const intensity = val / maxVal;
      const r = Math.round(234 * intensity);
      const g = Math.round(179 * intensity * 0.6);
      const b = Math.round(8 * intensity);
      const bg = `rgba(${r}, ${g + 80}, ${b + 20}, ${0.15 + intensity * 0.7})`;
      html += `<div class="heatmap-cell" style="background:${bg}" title="${row} ${data.cols[ci]}: ${val} covers">${val}</div>`;
    });
  });

  html += '</div>';
  container.innerHTML = html;
}

// === IG GROWTH ===
function initIGGrowth() {
  destroyChart('igGrowthChart');
  chartInstances['igGrowthChart'] = new Chart(document.getElementById('igGrowthChart'), {
    type: 'line',
    data: {
      labels: ['Sep', 'Oct', 'Nov', 'Dec', 'Jan', 'Feb'],
      datasets: [
        { label: 'Mango Coco', data: [12400, 13100, 13800, 14600, 15200, 16100], borderColor: '#f59e0b', tension: 0.4, pointRadius: 3 },
        { label: 'Issho', data: [5200, 5500, 5900, 6400, 6800, 7200], borderColor: '#22c55e', tension: 0.4, pointRadius: 3 },
        { label: 'Golden Brown', data: [1800, 2200, 2800, 3500, 4100, 4800], borderColor: '#d97706', tension: 0.4, pointRadius: 3 },
        { label: 'TMC', data: [3200, 4800, 6200, 8400, 10200, 11800], borderColor: '#eab308', tension: 0.4, pointRadius: 3 },
        { label: 'Red Wok', data: [2100, 2200, 2400, 2600, 2800, 2900], borderColor: '#ef4444', tension: 0.4, pointRadius: 3 }
      ]
    },
    options: { responsive: true, maintainAspectRatio: false }
  });
}

// Init overview on load
setTimeout(() => initCharts('overview'), 100);
</script>

</body>
</html>
